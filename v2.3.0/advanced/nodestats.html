
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>NodeStats &#8212; TopoStats 2.3.3.dev27+g279473507 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=2b4ec01c" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../_static/documentation_options.js?v=766c09a3"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'advanced/nodestats';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="2.3" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">TopoStats 2.3.3.dev27+g279473507 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../introduction.html">
    Introduction
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../installation.html">
    Installation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../usage.html">
    Usage
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../configuration.html">
    Configuration
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../contributing.html">
    Contributing
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button"
                data-bs-toggle="dropdown" aria-expanded="false"
                aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../notebooks.html">
    Notebooks
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../advanced.html">
    Advanced Documentation
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../workflow.html">
    Workflow
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../data_dictionary.html">
    Data Dictionary
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../related_software.html">
    Related Software
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../glossary.html">
    Glossary
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../faq.html">
    Frequently Asked Questions
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../autoapi/index.html">
    API Reference
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../introduction.html">
    Introduction
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../installation.html">
    Installation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../usage.html">
    Usage
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../configuration.html">
    Configuration
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../contributing.html">
    Contributing
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../notebooks.html">
    Notebooks
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../advanced.html">
    Advanced Documentation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../workflow.html">
    Workflow
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../data_dictionary.html">
    Data Dictionary
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../related_software.html">
    Related Software
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../glossary.html">
    Glossary
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../faq.html">
    Frequently Asked Questions
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../autoapi/index.html">
    API Reference
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<h3>Versions</h3>
<ul>
  <li><a href="../../v2.0.0/index.html">v2.0.0</a></li>
  <li><a href="../../v2.1.0/index.html">v2.1.0</a></li>
  <li><a href="../../v2.1.1/index.html">v2.1.1</a></li>
  <li><a href="../../v2.1.2/index.html">v2.1.2</a></li>
  <li><a href="../../v2.2.0/index.html">v2.2.0</a></li>
  <li><a href="../../v2.2.1/index.html">v2.2.1</a></li>
  <li><a href="../../v2.2.post0/index.html">v2.2.post0</a></li>
  <li><a href="nodestats.html">v2.3.0</a></li>
  <li><a href="../../v2.3.1/advanced/nodestats.html">v2.3.1</a></li>
  <li><a href="../../v2.3.2/advanced/nodestats.html">v2.3.2</a></li>
  <li><a href="../../v2.3.2rc1/advanced/nodestats.html">v2.3.2rc1</a></li>
  <li><a href="../../v2.3.2rc2/advanced/nodestats.html">v2.3.2rc2</a></li>
  <li><a href="../../main/advanced/nodestats.html">main</a></li>
</ul>
</div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">NodeStats</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="nodestats">
<h1>NodeStats<a class="headerlink" href="#nodestats" title="Link to this heading">#</a></h1>
<p>This section gives an in-depth overview of the steps taken in the NodeStats module.</p>
<section id="at-a-glance-crossing-analyses">
<h2>At a Glance : Crossing Analyses<a class="headerlink" href="#at-a-glance-crossing-analyses" title="Link to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">nodestats.py</span></code> module handles all the functions associated with identifying and analysing the crossing regions
(nodes) and crossing branches in pruned skeletons.</p>
<p>The quality of the resultant metrics and over/underlying branch classifications depend on the quality of the pruned
skeleton, the effectiveness of automating the joining of skeleton junction points through the parameters.</p>
<p><img alt="object skeleton with highlighted crossing points" src="../_images/overview1.png" /></p>
<p>This module identifies crossing regions from nearby skeleton junctions and analyses each branch emanating out from the
crossing to pair them, then determines the overlying and underlying strand using the full-width half-maximum from each
height trace passing through the crossing. It adds the number of identified crossings and the minimum and average pseudo
confidence values to the <code class="docutils literal notranslate"><span class="pre">all_statistics.csv</span></code>.</p>
<p>Some quick FYI’s:</p>
<ul class="simple">
<li><p><strong>Bad skeletons, bad classifications</strong> - If the skeleton does not lie along the backbone of the structure, it’s
resulting height trace and thus stacking order calculation may not be accurate.</p></li>
<li><p><strong>No skeletons in image</strong> - The NodeStats <code class="docutils literal notranslate"><span class="pre">all</span></code> images may not show the resultant skeletons if the plotting <code class="docutils literal notranslate"><span class="pre">dpi</span></code>
value is too low (varies based on image size) as these single pixel lines cannot be resolved by matplotlib.</p></li>
<li><p><strong>Incorrect pairing</strong> - Pairing of the branches emanating from a crossing is based on the assumption that the regions
being compared (<code class="docutils literal notranslate"><span class="pre">branch_pairing_length</span></code>) are below half the persistence length of the material, and as such they
should follow straight lines through the crossing region.</p></li>
<li><p><strong>Masked colours are relative</strong> - Any mask colours that may be produced by plots are relative to the mask values in
that image as they will always span the masked colourmap, and will not compare well across images if the range of mask
values differ.</p></li>
<li><p><strong>Odd numbered crossings</strong> - These can result from poor masking / pruning and are handled by looking further around
odd nodes to join them (<code class="docutils literal notranslate"><span class="pre">node_extend_dist</span></code>), and if they are still odd, the default behaviour results from the
<code class="docutils literal notranslate"><span class="pre">pair_odd_branches</span></code> parameter to pair as many as possible leaving one remaining, or to not pair any of them.</p></li>
</ul>
</section>
<section id="processing-steps">
<h2>Processing Steps<a class="headerlink" href="#processing-steps" title="Link to this heading">#</a></h2>
<section id="identify-skeleton-junctions">
<h3>1. Identify Skeleton Junctions<a class="headerlink" href="#identify-skeleton-junctions" title="Link to this heading">#</a></h3>
<p>The pruned skeletons undergo a 2D convolution with a 3x3 kernel of 1’s, and the skeleton is the remapped onto the
resultant image. This produces a non-binary skeleton where the value of each skeleton pixel is the count of it’s
neighbours + 1. This is used to produce a new skeleton image in with pixels labelled as:</p>
<ul class="simple">
<li><p>1 - Endpoints</p></li>
<li><p>2 - Skeleton segments</p></li>
<li><p>3 - Junctions</p></li>
</ul>
<p><img alt="skeleton to convolved skeleton image" src="../_images/convolved.png" /></p>
<p>This produces a skeleton mask (blue) where the junctions (green) and endpoints (pink) can be seen.</p>
</section>
<section id="clean-up-the-crossing-regions">
<h3>2. Clean-up the Crossing Regions<a class="headerlink" href="#clean-up-the-crossing-regions" title="Link to this heading">#</a></h3>
<p>The alignment of the skeleton onto the crossing backbone is key to obtaining good analyses from this module, especially
for accurate topological classifications and calculation of writhe signs. For this reason, a small area around the
junctions points are re-filled with the mask and skeletonised again using the height biasing skeletonisation approach.</p>
<p><img alt="refilling " src="../_images/tidy.png" /></p>
<p>This has been useful to align the skeletons at branch crossing points however, the modification to the skeleton has also
been known to cause problems as no additional pruning steps are done.</p>
</section>
<section id="connect-the-junctions">
<h3>3. Connect the Junctions<a class="headerlink" href="#connect-the-junctions" title="Link to this heading">#</a></h3>
<p>Skeleton segments which represent a crossing may not join up perfectly at a single pixel (junction) and as a result of
the skeletonisation procedure, may be offset from one another and need to be combined to represent the crossing region
or “node”. Therefore, junctions closer than the <code class="docutils literal notranslate"><span class="pre">node_joining_length</span></code> of each other define a crossing region, and the
pixels which span between the junctions along the skeleton are also labelled as part of the crossing.</p>
<p><img alt="convolved skeleton to nodes image" src="../_images/joining.png" /></p>
<p>Depending on the sample type or skeletonisation / pruning errors, there might exist an odd number of emanating branches
after this initial pairing. In DNA samples, we typically see this where just before a crossing region, the two strands
lie close to each other, creating an elongated crossing region in the skeletonisation representation. In order to
capture these for analysis, the <code class="docutils literal notranslate"><span class="pre">node_extend_dist</span></code> tells <em>only</em> odd-branch crossing regions to look for and extend to
other odd-branch crossing regions within this distance, using the shortest path possible along the skeleton. Coming
after the initial connection, this means that closer crossing regions can be joined, and that 3-branch nodes can be
joined through a 4-branch node to another 3-branch node.</p>
</section>
<section id="pair-the-branches">
<h3>4. Pair the Branches<a class="headerlink" href="#pair-the-branches" title="Link to this heading">#</a></h3>
<p>For each of these crossing regions, the skeletons are reduced to solely a single crossing and their emanating
branches. The part we are interested in, and obtain traces for are branch regions defined as extending upto the
<code class="docutils literal notranslate"><span class="pre">branch_pairing_length</span></code> away from the central crossing region. This length should be below half the persistence length
of the material, so that the branches should follow (roughly) straight lines through the crossing region.</p>
<p><img alt="paring vectors overlaid onto the emanating branches" src="../_images/pairing.png" /></p>
<p>This enables us to pair emanating branches based on the angles between their vectors using bipartite matching to obtain
the best pairing combinations to use for subsequent steps.</p>
</section>
<section id="height-traces">
<h3>5. Height Traces<a class="headerlink" href="#height-traces" title="Link to this heading">#</a></h3>
<p>For each paired branch in the crossing region, we can use a series of dilations to obtain two more accompanying branches
to average our traces across a few pixels and reduce the error in the skeleton position along the backbone at the
crossing. Using the underlying height values, and calculating the distance radially (not along the path) from the
highest point in the crossing (the node centre), a height trace of the topographic crossing can be used to find the
full-width half-maximum (FWHM) value of the crossing peak and determine which crossing branch lies atop (largest value)
or beneath (smallest value) the other.</p>
<p><img alt="crossing and height trace" src="../_images/height_trace.png" /></p>
<p>From the FWHM of the height traces, a pseudo confidence value is obtained using the equation below. It calculates the
ratio of the minimum to maximum value across all FWHM pairs of all crossing branches, N, (using combinatorics to pair
crossing branches if &gt;2):</p>
<p>$$
\text{crossing confidence} = \frac{1}{N} \sum_{\text{FWHM_pairs}} \left(1 -
\frac{\min(\text{FWHM_pairs})}{\max(\text{FWHM_pairs})}\right)
$$</p>
</section>
</section>
<section id="outputs">
<h2>Outputs<a class="headerlink" href="#outputs" title="Link to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">&lt;image&gt;_&lt;threshold&gt;_nodes</span></code> image shows the crossing regions highlighted in green, skeleton segments in blue, and
endpoints in pink.</p>
<p>For each grain, the following new columns are added to the <code class="docutils literal notranslate"><span class="pre">grainstats.csv</span></code> file:</p>
<table border="1" class="docutils">
<thead>
<tr>
<th>Column Name</th>
<th>Description</th>
<th>Data Type</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>num_crossings</code></td>
<td>The number of crossing regions found in the grain. Note: this will be equal to or lower than the number of junctions explained in the previous section.</td>
<td><code>integer</code></td>
</tr>
<tr>
<td><code>avg_crossing_confidence</code></td>
<td>The average of all pseudo crossing confidences. Used to estimate quality of predictions.</td>
<td><code>integer</code></td>
</tr>
<tr>
<td><code>min_crossing_confidence</code></td>
<td>The minimum of all pseudo crossing confidences. Used to estimate quality of predictions.</td>
<td><code>float</code></td>
</tr>
</tbody>
</table>
<p> </p>
<p>Note: Most information obtained during the NodeStats processing can be obtained from the <code class="docutils literal notranslate"><span class="pre">&lt;image_name&gt;.topostats</span></code> file
found within the <code class="docutils literal notranslate"><span class="pre">processed</span></code> folder and contains a multitude of grain and branch statistics such as:</p>
<ul class="simple">
<li><p>number of nodes per grain</p></li>
<li><p>node confidences</p></li>
<li><p>node coordinates</p></li>
<li><p>number of branches per node</p></li>
<li><p>branch distance array</p></li>
<li><p>branch height array</p></li>
<li><p>branch FWHM dictionary containing the FWHM, half max, and peak values</p></li>
<li><p>matched and unmatched branch angles</p></li>
</ul>
<p><img alt="TopoStats file - NodeStats structure" src="../_images/topostats_file.png" /> <strong>Note:</strong> The writhe sign is
identified in <code class="docutils literal notranslate"><span class="pre">ordered_traces.py</span></code>, not <code class="docutils literal notranslate"><span class="pre">nodestats</span></code> as the path needs directionality provided by the ordering. It is
added to the NodeStats dictionary as this carries the node statistics.</p>
</section>
<section id="diagnostic-images">
<h2>Diagnostic Images<a class="headerlink" href="#diagnostic-images" title="Link to this heading">#</a></h2>
<p>Images produced by the <code class="docutils literal notranslate"><span class="pre">plotting.image_set:</span> <span class="pre">all</span></code> for this module are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">25-convolved_skeleton</span></code> - The result of the convolution operation described in 1. The default “blue_green_pink”
colourmap for this image represent skeleton segments, junctions, and endpoints respectively.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">26-node_centres</span></code> - The highest pixel in each crossing region (green) with the same colourmap as above. This is where
the ‘0’ distance point corresponds to in the height traces.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nodes</span></code> folder:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">grain_&lt;X&gt;_node_&lt;Y&gt;_node_area_skeleton&gt;</span></code> - Contains the reduced area of grain number X and node number Y which
consists of the node in question and only it’s emanating branches.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">grain_&lt;X&gt;_node_&lt;Y&gt;_node_branch_mask&gt;</span></code> - Visualises the crossing branches where the length depends on
<code class="docutils literal notranslate"><span class="pre">branch_pairing_length</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">grain_&lt;X&gt;_node_&lt;Y&gt;_node_avg_mask&gt;</span></code> - Visualises the dilated crossing branches used to obtain an average height
trace along the crossing branches.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">grain_&lt;X&gt;_node_&lt;Y&gt;_linetrace_halfmax&gt;</span></code> - Shows the height trace of each crossing branch, and was used to determine
the FWHM. The vertical lines show the location of where the half-maximum was taken from.</p></li>
</ul>
</li>
</ul>
<p><img alt="Examples of diagnostic images" src="../_images/diagnostics1.png" /></p>
</section>
<section id="possible-uses">
<h2>Possible Uses<a class="headerlink" href="#possible-uses" title="Link to this heading">#</a></h2>
<p>This module would lend itself useful for measuring and quantifying complex overlapping structures, and is a requirement
for the <code class="docutils literal notranslate"><span class="pre">nodestats</span></code> method in <code class="docutils literal notranslate"><span class="pre">ordered_tracing</span></code> which orders the trace along a complex topology.</p>
<p>We have used this module to broadly quantify conformational differences between relaxed and supercoiled DNA samples
based on the number of crossing regions seen in samples of each grain. Additionally the FWHM results have been used to
confirm the classification topologically complex molecules via the highest confidence. The branch statistics have been
used to identify and quantify different conformations of topologically complex DNA and the effect of surface
deposition. Finally, splitting the odd-branched nodes enabled us to identify and measure the replicated and unreplicated
DNA segments in replication intermediates despite their complex writhed path. These analyses can be seen in our paper;
<a class="reference external" href="https://www.biorxiv.org/content/10.1101/2024.06.28.601212v1">Under or Over? Tracing Complex DNA Topologies with High Resolution Atomic Force
Microscopy</a>.</p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#at-a-glance-crossing-analyses">At a Glance : Crossing Analyses</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#processing-steps">Processing Steps</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#identify-skeleton-junctions">1. Identify Skeleton Junctions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#clean-up-the-crossing-regions">2. Clean-up the Crossing Regions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#connect-the-junctions">3. Connect the Junctions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pair-the-branches">4. Pair the Branches</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#height-traces">5. Height Traces</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#outputs">Outputs</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#diagnostic-images">Diagnostic Images</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#possible-uses">Possible Uses</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/advanced/nodestats.md.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2023, TopoStats authors.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>