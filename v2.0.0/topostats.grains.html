
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>grains &#8212; TopoStats 2.3.2.dev596+g13ec2e9a2 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=2b4ec01c" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/jquery.js?v=5d32c60e"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="_static/documentation_options.js?v=a6dcfaca"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'topostats.grains';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="grainstats" href="topostats.grainstats.html" />
    <link rel="prev" title="filters" href="topostats.filters.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">TopoStats 2.3.2.dev596+g13ec2e9a2 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="introduction.html">
    Introduction
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="installation.html">
    Installation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="usage.html">
    Usage
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="configuration.html">
    Configuration
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="contributing.html">
    Contributing
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button"
                data-bs-toggle="dropdown" aria-expanded="false"
                aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="workflow.html">
    Workflow
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="data_dictionary.html">
    Data Dictionary
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="related_software.html">
    Related Software
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="topostats.filters.html">
    filters
  </a>
</li>


<li class=" current active">
  <a class="nav-link dropdown-item nav-internal" href="#">
    grains
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="topostats.grainstats.html">
    grainstats
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="topostats.io.html">
    io
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="topostats.plottingfuncs.html">
    plottingfuncs
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="topostats.run_topostats.html">
    run_topostats
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="topostats.tracing.html">
    tracing
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="topostats.utils.html">
    utils
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="autoapi/index.html">
    API Reference
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="introduction.html">
    Introduction
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="installation.html">
    Installation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="usage.html">
    Usage
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="configuration.html">
    Configuration
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="contributing.html">
    Contributing
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="workflow.html">
    Workflow
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="data_dictionary.html">
    Data Dictionary
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="related_software.html">
    Related Software
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="topostats.filters.html">
    filters
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="#">
    grains
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="topostats.grainstats.html">
    grainstats
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="topostats.io.html">
    io
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="topostats.plottingfuncs.html">
    plottingfuncs
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="topostats.run_topostats.html">
    run_topostats
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="topostats.tracing.html">
    tracing
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="topostats.utils.html">
    utils
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="autoapi/index.html">
    API Reference
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<h3>Versions</h3>
<ul>
  <li><a href="topostats.grains.html">v2.0.0</a></li>
  <li><a href="../v2.1.0/index.html">v2.1.0</a></li>
  <li><a href="../v2.1.1/index.html">v2.1.1</a></li>
  <li><a href="../v2.1.2/index.html">v2.1.2</a></li>
  <li><a href="../v2.2.0/index.html">v2.2.0</a></li>
  <li><a href="../v2.2.1/index.html">v2.2.1</a></li>
  <li><a href="../v2.2.post0/index.html">v2.2.post0</a></li>
  <li><a href="../v2.3.0/index.html">v2.3.0</a></li>
  <li><a href="../v2.3.1/index.html">v2.3.1</a></li>
  <li><a href="../main/index.html">main</a></li>
</ul>
</div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">grains</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="module-topostats.grains">
<span id="grains"></span><h1>grains<a class="headerlink" href="#module-topostats.grains" title="Link to this heading">#</a></h1>
<p>Find grains in an image.</p>
<dl class="py class">
<dt class="sig sig-object py" id="topostats.grains.GrainCrop">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">topostats.grains.</span></span><span class="sig-name descname"><span class="pre">GrainCrop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float32</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_to_nm_scaling</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height_profiles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float32</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stats</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/topostats/grains.html#GrainCrop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#topostats.grains.GrainCrop" title="Link to this definition">#</a></dt>
<dd><p>Class for storing the crops of grains.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>npt.NDArray</em><em>[</em><em>np.float32</em><em>]</em>) – 2-D Numpy array of the cropped image.</p></li>
<li><p><strong>mask</strong> (npt.NDArray[<a href="#id3"><span class="problematic" id="id4">np.bool_</span></a>]) – 3-D Numpy tensor of the cropped mask.</p></li>
<li><p><strong>padding</strong> (<em>int</em>) – Padding added to the bounding box of the grain during cropping.</p></li>
<li><p><strong>bbox</strong> (<em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>, </em><em>int</em><em>, </em><em>int</em><em>]</em>) – Bounding box of the crop including padding.</p></li>
<li><p><strong>pixel_to_nm_scaling</strong> (<em>float</em>) – Pixel to nanometre scaling factor for the crop.</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – Filename of the image from which the crop was taken.</p></li>
<li><p><strong>height_profiles</strong> (<em>dict</em><em>[</em><em>int</em><em>, </em><em>[</em><em>int</em><em>, </em><em>npt.NDArray</em><em>[</em><em>np.float32</em><em>]</em><em>]</em><em>] </em><em>| </em><em>None</em>) – 3-D Numpy tensor of the height profiles.</p></li>
<li><p><strong>stats</strong> (<em>dict</em><em>[</em><em>int</em><em>, </em><em>dict</em><em>[</em><em>int</em><em>, </em><em>Any</em><em>]</em><em>] </em><em>| </em><em>None</em>) – Dictionary of grain statistics.</p></li>
</ul>
</dd>
<dt class="field-even">Attributes<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><a class="reference internal" href="#topostats.grains.GrainCrop.bbox" title="topostats.grains.GrainCrop.bbox"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bbox</span></code></a></dt><dd><p>Getter for the bounding box.</p>
</dd>
<dt><a class="reference internal" href="#topostats.grains.GrainCrop.filename" title="topostats.grains.GrainCrop.filename"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filename</span></code></a></dt><dd><p>Getter for the filename.</p>
</dd>
<dt><a class="reference internal" href="#topostats.grains.GrainCrop.height_profiles" title="topostats.grains.GrainCrop.height_profiles"><code class="xref py py-obj docutils literal notranslate"><span class="pre">height_profiles</span></code></a></dt><dd><p>Getter for the height_profile.</p>
</dd>
<dt><a class="reference internal" href="#topostats.grains.GrainCrop.image" title="topostats.grains.GrainCrop.image"><code class="xref py py-obj docutils literal notranslate"><span class="pre">image</span></code></a></dt><dd><p>Getter for the image.</p>
</dd>
<dt><a class="reference internal" href="#topostats.grains.GrainCrop.mask" title="topostats.grains.GrainCrop.mask"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mask</span></code></a></dt><dd><p>Getter for the mask.</p>
</dd>
<dt><a class="reference internal" href="#topostats.grains.GrainCrop.padding" title="topostats.grains.GrainCrop.padding"><code class="xref py py-obj docutils literal notranslate"><span class="pre">padding</span></code></a></dt><dd><p>Getter for the padding.</p>
</dd>
<dt><a class="reference internal" href="#topostats.grains.GrainCrop.pixel_to_nm_scaling" title="topostats.grains.GrainCrop.pixel_to_nm_scaling"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pixel_to_nm_scaling</span></code></a></dt><dd><p>Getter for the pixel to nanometre scaling factor.</p>
</dd>
<dt><a class="reference internal" href="#topostats.grains.GrainCrop.stats" title="topostats.grains.GrainCrop.stats"><code class="xref py py-obj docutils literal notranslate"><span class="pre">stats</span></code></a></dt><dd><p>Getter for the stats.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#topostats.grains.GrainCrop.debug_locate_difference" title="topostats.grains.GrainCrop.debug_locate_difference"><code class="xref py py-obj docutils literal notranslate"><span class="pre">debug_locate_difference</span></code></a>(other)</p></td>
<td><p>Debug function to find the culprit when two GrainCrop objects are not equal.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#topostats.grains.GrainCrop.grain_crop_to_dict" title="topostats.grains.GrainCrop.grain_crop_to_dict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">grain_crop_to_dict</span></code></a>()</p></td>
<td><p>Convert GrainCrop to dictionary indexed by attributes.</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="topostats.grains.GrainCrop.bbox">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bbox</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#topostats.grains.GrainCrop.bbox" title="Link to this definition">#</a></dt>
<dd><p>Getter for the bounding box.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Bounding box of the crop.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If the bounding box is not square.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topostats.grains.GrainCrop.debug_locate_difference">
<span class="sig-name descname"><span class="pre">debug_locate_difference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">object</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/topostats/grains.html#GrainCrop.debug_locate_difference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#topostats.grains.GrainCrop.debug_locate_difference" title="Link to this definition">#</a></dt>
<dd><p>Debug function to find the culprit when two GrainCrop objects are not equal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>other</strong> (<em>object</em>) – Object to compare to.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the objects are not equal</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="topostats.grains.GrainCrop.filename">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">filename</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#topostats.grains.GrainCrop.filename" title="Link to this definition">#</a></dt>
<dd><p>Getter for the filename.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The image filename.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topostats.grains.GrainCrop.grain_crop_to_dict">
<span class="sig-name descname"><span class="pre">grain_crop_to_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/topostats/grains.html#GrainCrop.grain_crop_to_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#topostats.grains.GrainCrop.grain_crop_to_dict" title="Link to this definition">#</a></dt>
<dd><p>Convert GrainCrop to dictionary indexed by attributes.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary indexed by attribute of the grain attributes.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict[str, Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="topostats.grains.GrainCrop.height_profiles">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">height_profiles</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#topostats.grains.GrainCrop.height_profiles" title="Link to this definition">#</a></dt>
<dd><p>Getter for the height_profile.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The image height_profile.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="topostats.grains.GrainCrop.image">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">image</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float32</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#topostats.grains.GrainCrop.image" title="Link to this definition">#</a></dt>
<dd><p>Getter for the image.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Numpy array of the image.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>npt.NDArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="topostats.grains.GrainCrop.mask">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mask</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#topostats.grains.GrainCrop.mask" title="Link to this definition">#</a></dt>
<dd><p>Getter for the mask.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Numpy array of the mask.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>npt.NDArray[<a href="#id5"><span class="problematic" id="id6">np.bool_</span></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="topostats.grains.GrainCrop.padding">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">padding</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#topostats.grains.GrainCrop.padding" title="Link to this definition">#</a></dt>
<dd><p>Getter for the padding.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The padding amount.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="topostats.grains.GrainCrop.pixel_to_nm_scaling">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pixel_to_nm_scaling</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#topostats.grains.GrainCrop.pixel_to_nm_scaling" title="Link to this definition">#</a></dt>
<dd><p>Getter for the pixel to nanometre scaling factor.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Pixel to nanometre scaling factor.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="topostats.grains.GrainCrop.stats">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">stats</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#topostats.grains.GrainCrop.stats" title="Link to this definition">#</a></dt>
<dd><p>Getter for the stats.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary of image statistics.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="topostats.grains.GrainCropsDirection">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">topostats.grains.</span></span><span class="sig-name descname"><span class="pre">GrainCropsDirection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">crops:</span> <span class="pre">dict[int,</span> <span class="pre">~topostats.grains.GrainCrop],</span> <span class="pre">full_mask_tensor:</span> <span class="pre">~numpy.ndarray[~typing.Any,</span> <span class="pre">~numpy.dtype[~numpy.bool]]</span> <span class="pre">=</span> <span class="pre">&lt;property</span> <span class="pre">object&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/topostats/grains.html#GrainCropsDirection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#topostats.grains.GrainCropsDirection" title="Link to this definition">#</a></dt>
<dd><p>Dataclass for storing the crops of grains in a particular imaging direction.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="topostats.grains.GrainCropsDirection.full_mask_tensor">
<span class="sig-name descname"><span class="pre">full_mask_tensor</span></span><a class="headerlink" href="#topostats.grains.GrainCropsDirection.full_mask_tensor" title="Link to this definition">#</a></dt>
<dd><p>Boolean WxHxC array of the full mask tensor (W = width ; H = height; C = class &gt;= 2).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>npt.NDArray[<a href="#id7"><span class="problematic" id="id8">np.bool_</span></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="topostats.grains.GrainCropsDirection.crops">
<span class="sig-name descname"><span class="pre">crops</span></span><a class="headerlink" href="#topostats.grains.GrainCropsDirection.crops" title="Link to this definition">#</a></dt>
<dd><p>Grain crops.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict[int, GrainCrops]</p>
</dd>
</dl>
</dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><a class="reference internal" href="#id0" title="topostats.grains.GrainCropsDirection.full_mask_tensor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">full_mask_tensor</span></code></a></dt><dd><p>Getter for the full mask tensor.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#topostats.grains.GrainCropsDirection.debug_locate_difference" title="topostats.grains.GrainCropsDirection.debug_locate_difference"><code class="xref py py-obj docutils literal notranslate"><span class="pre">debug_locate_difference</span></code></a>(other)</p></td>
<td><p>Debug function to find the culprit when two GrainCropsDirection objects are not equal.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#topostats.grains.GrainCropsDirection.grain_crops_direction_to_dict" title="topostats.grains.GrainCropsDirection.grain_crops_direction_to_dict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">grain_crops_direction_to_dict</span></code></a>()</p></td>
<td><p>Convert GrainCropsDirection to dictionary indexed by attributes.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#topostats.grains.GrainCropsDirection.update_full_mask_tensor" title="topostats.grains.GrainCropsDirection.update_full_mask_tensor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_full_mask_tensor</span></code></a>()</p></td>
<td><p>Update the full mask tensor from the grain crops.</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="topostats.grains.GrainCropsDirection.debug_locate_difference">
<span class="sig-name descname"><span class="pre">debug_locate_difference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">object</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/topostats/grains.html#GrainCropsDirection.debug_locate_difference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#topostats.grains.GrainCropsDirection.debug_locate_difference" title="Link to this definition">#</a></dt>
<dd><p>Debug function to find the culprit when two GrainCropsDirection objects are not equal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>other</strong> (<em>object</em>) – Object to compare to.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the objects are not equal.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id0">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">full_mask_tensor</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#id0" title="Link to this definition">#</a></dt>
<dd><p>Getter for the full mask tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Numpy array of the full mask tensor.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>npt.NDArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topostats.grains.GrainCropsDirection.grain_crops_direction_to_dict">
<span class="sig-name descname"><span class="pre">grain_crops_direction_to_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict[str,</span> <span class="pre">~numpy.ndarray[~typing.Any,</span> <span class="pre">~numpy.dtype[~numpy.bool]]</span> <span class="pre">|</span> <span class="pre">dict[slice(&lt;class</span> <span class="pre">'str'&gt;,</span> <span class="pre">typing.Any,</span> <span class="pre">None)]]</span></span></span><a class="reference internal" href="_modules/topostats/grains.html#GrainCropsDirection.grain_crops_direction_to_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#topostats.grains.GrainCropsDirection.grain_crops_direction_to_dict" title="Link to this definition">#</a></dt>
<dd><p>Convert GrainCropsDirection to dictionary indexed by attributes.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary indexed by attribute of the grain attributes.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict[str, Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topostats.grains.GrainCropsDirection.update_full_mask_tensor">
<span class="sig-name descname"><span class="pre">update_full_mask_tensor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/topostats/grains.html#GrainCropsDirection.update_full_mask_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#topostats.grains.GrainCropsDirection.update_full_mask_tensor" title="Link to this definition">#</a></dt>
<dd><p>Update the full mask tensor from the grain crops.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="topostats.grains.Grains">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">topostats.grains.</span></span><span class="sig-name descname"><span class="pre">Grains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_to_nm_scaling</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grain_crop_padding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unet_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold_method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">otsu_threshold_multiplier</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold_std_dev</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold_absolute</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area_thresholds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_edge_intersecting_grains</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classes_to_merge</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vetting</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/topostats/grains.html#Grains"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#topostats.grains.Grains" title="Link to this definition">#</a></dt>
<dd><p>Find grains in an image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>npt.NDArray</em>) – 2-D Numpy array of image.</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – File being processed (used in logging).</p></li>
<li><p><strong>pixel_to_nm_scaling</strong> (<em>float</em>) – Scaling of pixels to nanometres.</p></li>
<li><p><strong>grain_crop_padding</strong> (<em>int</em>) – Padding to add to the bounding box of the grain during cropping.</p></li>
<li><p><strong>unet_config</strong> (<em>dict</em><em>[</em><em>str</em><em>, </em><em>str</em><em> | </em><em>int</em><em> | </em><em>float</em><em> | </em><em>tuple</em><em>[</em><em>int</em><em> | </em><em>None</em><em>, </em><em>int</em><em>, </em><em>int</em><em>, </em><em>int</em><em>] </em><em>| </em><em>None</em><em>]</em>) – <p>Configuration for the UNet model.
model_path: str</p>
<blockquote>
<div><p>Path to the UNet model.</p>
</div></blockquote>
<dl class="simple">
<dt>upper_norm_bound: float</dt><dd><p>Upper bound for normalising the image.</p>
</dd>
<dt>lower_norm_bound: float</dt><dd><p>Lower bound for normalising the image.</p>
</dd>
</dl>
</p></li>
<li><p><strong>threshold_method</strong> (<em>str</em>) – Method for determining thershold to mask values, default is ‘otsu’.</p></li>
<li><p><strong>otsu_threshold_multiplier</strong> (<em>float</em><em> | </em><em>None</em>) – Factor by which the below threshold is to be scaled prior to masking.</p></li>
<li><p><strong>threshold_std_dev</strong> (<em>dict</em><em>[</em><em>str</em><em>, </em><em>float</em><em> | </em><em>list</em><em>] </em><em>| </em><em>None</em>) – Dictionary of ‘below’ and ‘above’ factors by which standard deviation is multiplied to derive the threshold
if threshold_method is ‘std_dev’.</p></li>
<li><p><strong>threshold_absolute</strong> (<em>dict</em><em>[</em><em>str</em><em>, </em><em>float</em><em> | </em><em>list</em><em>] </em><em>| </em><em>None</em>) – Dictionary of absolute ‘below’ and ‘above’ thresholds for grain finding.</p></li>
<li><p><strong>area_thresholds</strong> (<em>dict</em><em>[</em><em>str</em><em>, </em><em>list</em><em>[</em><em>float</em><em> | </em><em>None</em><em>]</em><em>]</em>) – Dictionary of above and below grain’s area thresholds.</p></li>
<li><p><strong>direction</strong> (<em>str</em>) – Direction for which grains are to be detected, valid values are ‘above’, ‘below’ and ‘both’.</p></li>
<li><p><strong>remove_edge_intersecting_grains</strong> (<em>bool</em>) – Whether or not to remove grains that intersect the edge of the image.</p></li>
<li><p><strong>classes_to_merge</strong> (<em>list</em><em>[</em><em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>] </em><em>| </em><em>None</em>) – List of tuples of classes to merge.</p></li>
<li><p><strong>vetting</strong> (<em>dict</em><em> | </em><em>None</em>) – Dictionary of vetting parameters.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#topostats.grains.Grains.area_thresholding_tensor" title="topostats.grains.Grains.area_thresholding_tensor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">area_thresholding_tensor</span></code></a>(grain_mask_tensor, ...)</p></td>
<td><p>Remove objects larger and smaller than the specified thresholds.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#topostats.grains.Grains.assemble_grain_mask_tensor_from_crops" title="topostats.grains.Grains.assemble_grain_mask_tensor_from_crops"><code class="xref py py-obj docutils literal notranslate"><span class="pre">assemble_grain_mask_tensor_from_crops</span></code></a>(...)</p></td>
<td><p>Combine individual grain crops into a single grain mask tensor.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#topostats.grains.Grains.bbox_size_thresholding_tensor" title="topostats.grains.Grains.bbox_size_thresholding_tensor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bbox_size_thresholding_tensor</span></code></a>(...)</p></td>
<td><p>Remove objects whose bounding box is smaller than the specified threshold.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#topostats.grains.Grains.calculate_region_connection_regions" title="topostats.grains.Grains.calculate_region_connection_regions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calculate_region_connection_regions</span></code></a>(...)</p></td>
<td><p>Get a list of connection regions between two classes.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#topostats.grains.Grains.construct_full_mask_from_graincrops" title="topostats.grains.Grains.construct_full_mask_from_graincrops"><code class="xref py py-obj docutils literal notranslate"><span class="pre">construct_full_mask_from_graincrops</span></code></a>(...)</p></td>
<td><p>Construct a full mask tensor from the grain crops.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#topostats.grains.Grains.convert_classes_to_nearby_classes" title="topostats.grains.Grains.convert_classes_to_nearby_classes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">convert_classes_to_nearby_classes</span></code></a>(...[, ...])</p></td>
<td><p>Convert all but the largest regions of one class into another class provided the former touches the latter.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#topostats.grains.Grains.convert_classes_when_too_big_or_small" title="topostats.grains.Grains.convert_classes_when_too_big_or_small"><code class="xref py py-obj docutils literal notranslate"><span class="pre">convert_classes_when_too_big_or_small</span></code></a>(...)</p></td>
<td><p>Convert classes when they are too big or too small based on size thresholds.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#topostats.grains.Grains.extract_grains_from_full_image_tensor" title="topostats.grains.Grains.extract_grains_from_full_image_tensor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">extract_grains_from_full_image_tensor</span></code></a>(image, ...)</p></td>
<td><p>Extract grains from the full image mask tensor.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#topostats.grains.Grains.find_grains" title="topostats.grains.Grains.find_grains"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_grains</span></code></a>()</p></td>
<td><p>Find grains.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#topostats.grains.Grains.flatten_multi_class_tensor" title="topostats.grains.Grains.flatten_multi_class_tensor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">flatten_multi_class_tensor</span></code></a>(grain_mask_tensor)</p></td>
<td><p>Flatten a multi-class image tensor to a single binary mask.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#topostats.grains.Grains.get_individual_grain_crops" title="topostats.grains.Grains.get_individual_grain_crops"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_individual_grain_crops</span></code></a>(grain_mask_tensor)</p></td>
<td><p>Get individual grain crops from an image tensor.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#topostats.grains.Grains.get_multi_class_grain_bounding_boxes" title="topostats.grains.Grains.get_multi_class_grain_bounding_boxes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_multi_class_grain_bounding_boxes</span></code></a>(...)</p></td>
<td><p>Get the bounding boxes for each grain in a multi-class image tensor.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#topostats.grains.Grains.get_region_properties" title="topostats.grains.Grains.get_region_properties"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_region_properties</span></code></a>(image, **kwargs)</p></td>
<td><p>Extract the properties of each region.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#topostats.grains.Grains.graincrops_merge_classes" title="topostats.grains.Grains.graincrops_merge_classes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">graincrops_merge_classes</span></code></a>(graincrops, ...)</p></td>
<td><p>Merge classes in the grain crops.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#topostats.grains.Grains.graincrops_remove_objects_too_small_to_process" title="topostats.grains.Grains.graincrops_remove_objects_too_small_to_process"><code class="xref py py-obj docutils literal notranslate"><span class="pre">graincrops_remove_objects_too_small_to_process</span></code></a>(...)</p></td>
<td><p>Remove objects that are too small to process from each class of the grain crops.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#topostats.grains.Grains.graincrops_update_background_class" title="topostats.grains.Grains.graincrops_update_background_class"><code class="xref py py-obj docutils literal notranslate"><span class="pre">graincrops_update_background_class</span></code></a>(graincrops)</p></td>
<td><p>Update the background class in the grain crops.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#topostats.grains.Grains.improve_grain_segmentation_unet" title="topostats.grains.Grains.improve_grain_segmentation_unet"><code class="xref py py-obj docutils literal notranslate"><span class="pre">improve_grain_segmentation_unet</span></code></a>(graincrops, ...)</p></td>
<td><p>Use a UNet model to re-segment existing grains to improve their accuracy.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#topostats.grains.Grains.keep_largest_labelled_region" title="topostats.grains.Grains.keep_largest_labelled_region"><code class="xref py py-obj docutils literal notranslate"><span class="pre">keep_largest_labelled_region</span></code></a>(labelled_image)</p></td>
<td><p>Keep only the largest region in a labelled image.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#topostats.grains.Grains.keep_largest_labelled_region_classes" title="topostats.grains.Grains.keep_largest_labelled_region_classes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">keep_largest_labelled_region_classes</span></code></a>(...)</p></td>
<td><p>Keep only the largest region in specific classes.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#topostats.grains.Grains.label_regions" title="topostats.grains.Grains.label_regions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">label_regions</span></code></a>(image[, background])</p></td>
<td><p>Label regions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#topostats.grains.Grains.merge_classes" title="topostats.grains.Grains.merge_classes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">merge_classes</span></code></a>(grain_mask_tensor, ...)</p></td>
<td><p>Merge classes in a grain mask tensor and add them to the grain tensor.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#topostats.grains.Grains.multi_class_thresholding" title="topostats.grains.Grains.multi_class_thresholding"><code class="xref py py-obj docutils literal notranslate"><span class="pre">multi_class_thresholding</span></code></a>(image, thresholds, ...)</p></td>
<td><p>Perform multi-class thresholding on an image to obtain a mask tensor.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#topostats.grains.Grains.remove_disconnected_grains" title="topostats.grains.Grains.remove_disconnected_grains"><code class="xref py py-obj docutils literal notranslate"><span class="pre">remove_disconnected_grains</span></code></a>(...)</p></td>
<td><p>Remove grains that are not connected to the original grains.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#topostats.grains.Grains.remove_objects_too_small_to_process" title="topostats.grains.Grains.remove_objects_too_small_to_process"><code class="xref py py-obj docutils literal notranslate"><span class="pre">remove_objects_too_small_to_process</span></code></a>(image, ...)</p></td>
<td><p>Remove objects whose dimensions in pixels are too small to process.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#topostats.grains.Grains.tidy_border_tensor" title="topostats.grains.Grains.tidy_border_tensor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tidy_border_tensor</span></code></a>(grain_mask_tensor)</p></td>
<td><p>Remove whole grains touching the border.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#topostats.grains.Grains.update_background_class" title="topostats.grains.Grains.update_background_class"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_background_class</span></code></a>(grain_mask_tensor)</p></td>
<td><p>Update the background class to reflect the other classes.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#topostats.grains.Grains.vet_class_connection_points" title="topostats.grains.Grains.vet_class_connection_points"><code class="xref py py-obj docutils literal notranslate"><span class="pre">vet_class_connection_points</span></code></a>(...)</p></td>
<td><p>Vet the number of connection points between regions in specific classes.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#topostats.grains.Grains.vet_class_sizes_single_grain" title="topostats.grains.Grains.vet_class_sizes_single_grain"><code class="xref py py-obj docutils literal notranslate"><span class="pre">vet_class_sizes_single_grain</span></code></a>(...)</p></td>
<td><p>Remove regions of particular classes based on size thresholds.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#topostats.grains.Grains.vet_grains" title="topostats.grains.Grains.vet_grains"><code class="xref py py-obj docutils literal notranslate"><span class="pre">vet_grains</span></code></a>(graincrops, ...)</p></td>
<td><p>Vet grains in a grain mask tensor based on a variety of criteria.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#topostats.grains.Grains.vet_numbers_of_regions_single_grain" title="topostats.grains.Grains.vet_numbers_of_regions_single_grain"><code class="xref py py-obj docutils literal notranslate"><span class="pre">vet_numbers_of_regions_single_grain</span></code></a>(...)</p></td>
<td><p>Check if the number of regions of different classes for a single grain is within thresholds.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#topostats.grains.Grains.vet_whole_grain_size" title="topostats.grains.Grains.vet_whole_grain_size"><code class="xref py py-obj docutils literal notranslate"><span class="pre">vet_whole_grain_size</span></code></a>(grain_mask_tensor, ...)</p></td>
<td><p>Vet the size of the whole grain based on size thresholds.</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="topostats.grains.Grains.area_thresholding_tensor">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">area_thresholding_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grain_mask_tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area_thresholds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_to_nm_scaling</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/topostats/grains.html#Grains.area_thresholding_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#topostats.grains.Grains.area_thresholding_tensor" title="Link to this definition">#</a></dt>
<dd><p>Remove objects larger and smaller than the specified thresholds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grain_mask_tensor</strong> (<em>npt.NDArray</em>) – 3-D Numpy array of the full mask tensor.</p></li>
<li><p><strong>area_thresholds</strong> (<em>tuple</em>) – List of area thresholds (in nanometres squared), first is the lower limit for size, second is the upper.</p></li>
<li><p><strong>pixel_to_nm_scaling</strong> (<em>float</em>) – Scaling of pixels to nanometres.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>3-D Numpy array with small and large objects removed.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>npt.NDArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topostats.grains.Grains.assemble_grain_mask_tensor_from_crops">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">assemble_grain_mask_tensor_from_crops</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grain_mask_tensor_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grain_crops_and_bounding_boxes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/topostats/grains.html#Grains.assemble_grain_mask_tensor_from_crops"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#topostats.grains.Grains.assemble_grain_mask_tensor_from_crops" title="Link to this definition">#</a></dt>
<dd><p>Combine individual grain crops into a single grain mask tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grain_mask_tensor_shape</strong> (<em>tuple</em>) – Shape of the grain mask tensor.</p></li>
<li><p><strong>grain_crops_and_bounding_boxes</strong> (<em>list</em>) – List of dictionaries containing the grain crops and bounding boxes.
Structure: [{“grain_tensor”: npt.NDArray, “bounding_box”: tuple, “padding”: int}].</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>3-D Numpy array of the grain mask tensor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>npt.NDArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topostats.grains.Grains.bbox_size_thresholding_tensor">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bbox_size_thresholding_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grain_mask_tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox_size_thresholds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/topostats/grains.html#Grains.bbox_size_thresholding_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#topostats.grains.Grains.bbox_size_thresholding_tensor" title="Link to this definition">#</a></dt>
<dd><p>Remove objects whose bounding box is smaller than the specified threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grain_mask_tensor</strong> (npt.NDArray[<a href="#id9"><span class="problematic" id="id10">np.bool_</span></a>]) – 3-D Numpy array of the full mask tensor.</p></li>
<li><p><strong>bbox_size_thresholds</strong> (<em>tuple</em><em>[</em><em>int</em><em> | </em><em>None</em><em>, </em><em>int</em><em> | </em><em>None</em><em>]</em>) – List of bounding box size thresholds (in pixels), first is the lower limit for size, second is the upper.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>3-D Numpy array with objects removed that are too small to process.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>npt.NDArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topostats.grains.Grains.calculate_region_connection_regions">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_region_connection_regions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grain_mask_tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/topostats/grains.html#Grains.calculate_region_connection_regions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#topostats.grains.Grains.calculate_region_connection_regions" title="Link to this definition">#</a></dt>
<dd><p>Get a list of connection regions between two classes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grain_mask_tensor</strong> (<em>npt.NDArray</em>) – 3-D Numpy array of the grain mask tensor.</p></li>
<li><p><strong>classes</strong> (<em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em>) – Tuple pair of classes to calculate the connection regions.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>int</em> – Number of connection regions.</p></li>
<li><p><em>npt.NDArray</em> – 2-D Numpy array of the intersection labels.</p></li>
<li><p><em>dict</em> – Dictionary of connection points indexed by region label.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topostats.grains.Grains.construct_full_mask_from_graincrops">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">construct_full_mask_from_graincrops</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graincrops</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#topostats.grains.GrainCrop" title="topostats.grains.GrainCrop"><span class="pre">GrainCrop</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/topostats/grains.html#Grains.construct_full_mask_from_graincrops"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#topostats.grains.Grains.construct_full_mask_from_graincrops" title="Link to this definition">#</a></dt>
<dd><p>Construct a full mask tensor from the grain crops.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>graincrops</strong> (<em>dict</em><em>[</em><em>int</em><em>, </em><a class="reference internal" href="#topostats.grains.GrainCrop" title="topostats.grains.GrainCrop"><em>GrainCrop</em></a><em>]</em>) – Dictionary of grain crops.</p></li>
<li><p><strong>image_shape</strong> (<em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>, </em><em>int</em><em>]</em>) – Shape of the original image.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>HxWxC Numpy array of the full mask tensor (H = height, W = width, C = class &gt;= 2).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>npt.NDArray[<a href="#id11"><span class="problematic" id="id12">np.bool_</span></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topostats.grains.Grains.convert_classes_to_nearby_classes">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">convert_classes_to_nearby_classes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grain_mask_tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classes_to_convert</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_touching_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/topostats/grains.html#Grains.convert_classes_to_nearby_classes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#topostats.grains.Grains.convert_classes_to_nearby_classes" title="Link to this definition">#</a></dt>
<dd><p>Convert all but the largest regions of one class into another class provided the former touches the latter.</p>
<p>Specifically, it takes a list of tuples of two integers (dubbed class A and class B). For each class A, class B
pair, it will find the largest region of class A and flag it to be ignored. Then for each non-largest region of
class A, it will check if it touches any class B region (within the <code class="docutils literal notranslate"><span class="pre">class_touching_threshold</span></code> distance). If it
does, it will convert the region to class B.</p>
<p>This is useful for situations where you want just one region of class A and the model has a habit of producing
small regions of class A interspersed in the class B regions, which should be class B instead.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grain_mask_tensor</strong> (<em>npt.NDArray</em>) – 3-D Numpy array of the grain mask tensor.</p></li>
<li><p><strong>classes_to_convert</strong> (<em>list</em>) – List of tuples of classes to convert. Structure is [(class_a, class_b)].</p></li>
<li><p><strong>class_touching_threshold</strong> (<em>int</em>) – Number of dilation passes to do to determine class A connectivity with class B.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>3-D Numpy array of the grain mask tensor with classes converted.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>npt.NDArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topostats.grains.Grains.convert_classes_when_too_big_or_small">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">convert_classes_when_too_big_or_small</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grain_mask_tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_to_nm_scaling</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_conversion_size_thresholds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/topostats/grains.html#Grains.convert_classes_when_too_big_or_small"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#topostats.grains.Grains.convert_classes_when_too_big_or_small" title="Link to this definition">#</a></dt>
<dd><p>Convert classes when they are too big or too small based on size thresholds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grain_mask_tensor</strong> (<em>npt.NDArray</em>) – 3-D Numpy array of the grain mask tensor.</p></li>
<li><p><strong>pixel_to_nm_scaling</strong> (<em>float</em>) – Scaling of pixels to nanometres.</p></li>
<li><p><strong>class_conversion_size_thresholds</strong> (<em>list</em>) – List of class conversion size thresholds.
Structure is [(class_index, class_to_convert_to_if_to_small, class_to_convert_to_if_too_big),
(lower_threshold, upper_threshold)].</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>3-D Numpy array of the grain mask tensor with classes converted based on size thresholds.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>npt.NDArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topostats.grains.Grains.extract_grains_from_full_image_tensor">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">extract_grains_from_full_image_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float32</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_mask_tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_to_nm_scaling</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#topostats.grains.GrainCrop" title="topostats.grains.GrainCrop"><span class="pre">GrainCrop</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/topostats/grains.html#Grains.extract_grains_from_full_image_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#topostats.grains.Grains.extract_grains_from_full_image_tensor" title="Link to this definition">#</a></dt>
<dd><p>Extract grains from the full image mask tensor.</p>
<p>Grains are detected using connected components across all classes in the full mask tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>npt.NDArray</em><em>[</em><em>np.float32</em><em>]</em>) – 2-D Numpy array of the image.</p></li>
<li><p><strong>full_mask_tensor</strong> (npt.NDArray[<a href="#id13"><span class="problematic" id="id14">np.bool_</span></a>]) – 3-D NxNxC boolean numpy array of all the class masks for the image.</p></li>
<li><p><strong>padding</strong> (<em>int</em>) – Padding added to the bounding box of the grain before cropping.</p></li>
<li><p><strong>pixel_to_nm_scaling</strong> (<em>float</em>) – Pixel to nanometre scaling factor.</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – Filename of the image.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary of grain crops.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict[int, <a class="reference internal" href="#topostats.grains.GrainCrop" title="topostats.grains.GrainCrop">GrainCrop</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topostats.grains.Grains.find_grains">
<span class="sig-name descname"><span class="pre">find_grains</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/topostats/grains.html#Grains.find_grains"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#topostats.grains.Grains.find_grains" title="Link to this definition">#</a></dt>
<dd><p>Find grains.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topostats.grains.Grains.flatten_multi_class_tensor">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">flatten_multi_class_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grain_mask_tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/topostats/grains.html#Grains.flatten_multi_class_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#topostats.grains.Grains.flatten_multi_class_tensor" title="Link to this definition">#</a></dt>
<dd><p>Flatten a multi-class image tensor to a single binary mask.</p>
<p>The returned tensor is of boolean type in case there are multiple hits in the same pixel. We dont want to have
2s, 3s etc because this would cause issues in labelling and cause erroneous grains within grains.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>grain_mask_tensor</strong> (<em>npt.NDArray</em>) – Multi class grain mask tensor tensor of shape (N, N, C).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Combined binary mask of all but the background class (:, :, 0).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>npt.NDArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topostats.grains.Grains.get_individual_grain_crops">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_individual_grain_crops</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grain_mask_tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/topostats/grains.html#Grains.get_individual_grain_crops"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#topostats.grains.Grains.get_individual_grain_crops" title="Link to this definition">#</a></dt>
<dd><p>Get individual grain crops from an image tensor.</p>
<p>Fetches individual grain crops from an image tensor, but zeros any non-connected grains
in the crop region. This is to ensure that other grains do not affect further processing
steps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grain_mask_tensor</strong> (<em>npt.NDArray</em>) – 3-D Numpy array of image tensor.</p></li>
<li><p><strong>padding</strong> (<em>int</em>) – Padding to add to the bounding box of the grain before cropping. Default is 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>list[npt.NDArray]</em> – List of individual grain crops.</p></li>
<li><p><em>list[npt.NDArray]</em> – List of bounding boxes for each grain.</p></li>
<li><p><em>int</em> – Padding used for the bounding boxes.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topostats.grains.Grains.get_multi_class_grain_bounding_boxes">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_multi_class_grain_bounding_boxes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grain_mask_tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/topostats/grains.html#Grains.get_multi_class_grain_bounding_boxes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#topostats.grains.Grains.get_multi_class_grain_bounding_boxes" title="Link to this definition">#</a></dt>
<dd><p>Get the bounding boxes for each grain in a multi-class image tensor.</p>
<p>Finds the bounding boxes for each grain in a multi-class image tensor. Grains can span multiple classes, so the
bounding boxes are found for the combined binary mask of contiguous grains across all classes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>grain_mask_tensor</strong> (<em>npt.NDArray</em>) – 3-D Numpy array of grain mask tensor.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary of bounding boxes indexed by grain number.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topostats.grains.Grains.get_region_properties">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_region_properties</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/topostats/grains.html#Grains.get_region_properties"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#topostats.grains.Grains.get_region_properties" title="Link to this definition">#</a></dt>
<dd><p>Extract the properties of each region.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>np.array</em>) – Numpy array representing image.</p></li>
<li><p><strong>**kwargs</strong> – Arguments passed to ‘skimage.measure.regionprops(<a href="#id1"><span class="problematic" id="id2">**</span></a>kwargs)’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of region property objects.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topostats.grains.Grains.graincrops_merge_classes">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">graincrops_merge_classes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graincrops</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#topostats.grains.GrainCrop" title="topostats.grains.GrainCrop"><span class="pre">GrainCrop</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classes_to_merge</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#topostats.grains.GrainCrop" title="topostats.grains.GrainCrop"><span class="pre">GrainCrop</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/topostats/grains.html#Grains.graincrops_merge_classes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#topostats.grains.Grains.graincrops_merge_classes" title="Link to this definition">#</a></dt>
<dd><p>Merge classes in the grain crops.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>graincrops</strong> (<em>dict</em><em>[</em><em>int</em><em>, </em><a class="reference internal" href="#topostats.grains.GrainCrop" title="topostats.grains.GrainCrop"><em>GrainCrop</em></a><em>]</em>) – Dictionary of grain crops.</p></li>
<li><p><strong>classes_to_merge</strong> (<em>list</em><em> | </em><em>None</em>) – List of tuples for classes to merge, can be any number of classes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary of grain crops with classes merged.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict[int, <a class="reference internal" href="#topostats.grains.GrainCrop" title="topostats.grains.GrainCrop">GrainCrop</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topostats.grains.Grains.graincrops_remove_objects_too_small_to_process">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">graincrops_remove_objects_too_small_to_process</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graincrops</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#topostats.grains.GrainCrop" title="topostats.grains.GrainCrop"><span class="pre">GrainCrop</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_object_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_object_bbox_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#topostats.grains.GrainCrop" title="topostats.grains.GrainCrop"><span class="pre">GrainCrop</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/topostats/grains.html#Grains.graincrops_remove_objects_too_small_to_process"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#topostats.grains.Grains.graincrops_remove_objects_too_small_to_process" title="Link to this definition">#</a></dt>
<dd><p>Remove objects that are too small to process from each class of the grain crops.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>graincrops</strong> (<em>dict</em><em>[</em><em>int</em><em>, </em><a class="reference internal" href="#topostats.grains.GrainCrop" title="topostats.grains.GrainCrop"><em>GrainCrop</em></a><em>]</em>) – Dictionary of grain crops.</p></li>
<li><p><strong>min_object_size</strong> (<em>int</em>) – Minimum object size to keep (pixels).</p></li>
<li><p><strong>min_object_bbox_size</strong> (<em>int</em>) – Minimum object bounding box size to keep (pixels^2).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary of grain crops with objects too small to process removed.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict[int, <a class="reference internal" href="#topostats.grains.GrainCrop" title="topostats.grains.GrainCrop">GrainCrop</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topostats.grains.Grains.graincrops_update_background_class">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">graincrops_update_background_class</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graincrops</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#topostats.grains.GrainCrop" title="topostats.grains.GrainCrop"><span class="pre">GrainCrop</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#topostats.grains.GrainCrop" title="topostats.grains.GrainCrop"><span class="pre">GrainCrop</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/topostats/grains.html#Grains.graincrops_update_background_class"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#topostats.grains.Grains.graincrops_update_background_class" title="Link to this definition">#</a></dt>
<dd><p>Update the background class in the grain crops.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>graincrops</strong> (<em>dict</em><em>[</em><em>int</em><em>, </em><a class="reference internal" href="#topostats.grains.GrainCrop" title="topostats.grains.GrainCrop"><em>GrainCrop</em></a><em>]</em>) – Dictionary of grain crops.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary of grain crops with updated background class.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict[int, <a class="reference internal" href="#topostats.grains.GrainCrop" title="topostats.grains.GrainCrop">GrainCrop</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topostats.grains.Grains.improve_grain_segmentation_unet">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">improve_grain_segmentation_unet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graincrops</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#topostats.grains.GrainCrop" title="topostats.grains.GrainCrop"><span class="pre">GrainCrop</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unet_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#topostats.grains.GrainCrop" title="topostats.grains.GrainCrop"><span class="pre">GrainCrop</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/topostats/grains.html#Grains.improve_grain_segmentation_unet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#topostats.grains.Grains.improve_grain_segmentation_unet" title="Link to this definition">#</a></dt>
<dd><p>Use a UNet model to re-segment existing grains to improve their accuracy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>graincrops</strong> (<em>dict</em><em>[</em><em>int</em><em>, </em><a class="reference internal" href="#topostats.grains.GrainCrop" title="topostats.grains.GrainCrop"><em>GrainCrop</em></a><em>]</em>) – Dictionary of grain crops.</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – File being processed (used in logging).</p></li>
<li><p><strong>direction</strong> (<em>str</em>) – Direction of threshold for which bounding boxes are being calculated.</p></li>
<li><p><strong>unet_config</strong> (<em>dict</em><em>[</em><em>str</em><em>, </em><em>str</em><em> | </em><em>int</em><em> | </em><em>float</em><em> | </em><em>tuple</em><em>[</em><em>int</em><em> | </em><em>None</em><em>, </em><em>int</em><em>, </em><em>int</em><em>, </em><em>int</em><em>] </em><em>| </em><em>None</em><em>]</em>) – <p>Configuration for the UNet model.
model_path: str</p>
<blockquote>
<div><p>Path to the UNet model.</p>
</div></blockquote>
<dl class="simple">
<dt>grain_crop_padding: int</dt><dd><p>Padding to add to the bounding box of the grain before cropping.</p>
</dd>
<dt>upper_norm_bound: float</dt><dd><p>Upper bound for normalising the image.</p>
</dd>
<dt>lower_norm_bound: float</dt><dd><p>Lower bound for normalising the image.</p>
</dd>
<dt>confidence: float</dt><dd><p>Confidence threshold for the UNet model. Smaller is more generous, larger is more strict.</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary of (hopefully) improved grain crops.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict[int, <a class="reference internal" href="#topostats.grains.GrainCrop" title="topostats.grains.GrainCrop">GrainCrop</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topostats.grains.Grains.keep_largest_labelled_region">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">keep_largest_labelled_region</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labelled_image</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">int32</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/topostats/grains.html#Grains.keep_largest_labelled_region"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#topostats.grains.Grains.keep_largest_labelled_region" title="Link to this definition">#</a></dt>
<dd><p>Keep only the largest region in a labelled image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>labelled_image</strong> (<em>npt.NDArray</em>) – 2-D Numpy array of labelled regions.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>2-D Numpy boolean array of labelled regions with only the largest region.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>npt.NDArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topostats.grains.Grains.keep_largest_labelled_region_classes">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">keep_largest_labelled_region_classes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">single_grain_mask_tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_largest_labelled_regions_classes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/topostats/grains.html#Grains.keep_largest_labelled_region_classes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#topostats.grains.Grains.keep_largest_labelled_region_classes" title="Link to this definition">#</a></dt>
<dd><p>Keep only the largest region in specific classes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>single_grain_mask_tensor</strong> (<em>npt.NDArray</em>) – 3-D Numpy array of the grain mask tensor.</p></li>
<li><p><strong>keep_largest_labelled_regions_classes</strong> (<em>list</em><em>[</em><em>int</em><em>]</em>) – List of classes to keep only the largest region.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>3-D Numpy array of the grain mask tensor with only the largest regions in specific classes.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>npt.NDArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topostats.grains.Grains.label_regions">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">label_regions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">background</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/topostats/grains.html#Grains.label_regions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#topostats.grains.Grains.label_regions" title="Link to this definition">#</a></dt>
<dd><p>Label regions.</p>
<p>This method is used twice, once prior to removal of small regions and again afterwards which is why an image
must be supplied rather than using ‘self’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>npt.NDArray</em>) – 2-D Numpy array of image.</p></li>
<li><p><strong>background</strong> (<em>int</em>) – Value used to indicate background of image. Default = 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>2-D Numpy array of image with regions numbered.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>npt.NDArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topostats.grains.Grains.merge_classes">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">merge_classes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grain_mask_tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classes_to_merge</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/topostats/grains.html#Grains.merge_classes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#topostats.grains.Grains.merge_classes" title="Link to this definition">#</a></dt>
<dd><p>Merge classes in a grain mask tensor and add them to the grain tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grain_mask_tensor</strong> (<em>npt.NDArray</em>) – 3-D Numpy array of the grain mask tensor.</p></li>
<li><p><strong>classes_to_merge</strong> (<em>list</em><em> | </em><em>None</em>) – List of tuples for classes to merge, can be any number of classes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>3-D Numpy array of the grain mask tensor with classes merged.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>npt.NDArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topostats.grains.Grains.multi_class_thresholding">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">multi_class_thresholding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresholds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold_direction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/topostats/grains.html#Grains.multi_class_thresholding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#topostats.grains.Grains.multi_class_thresholding" title="Link to this definition">#</a></dt>
<dd><p>Perform multi-class thresholding on an image to obtain a mask tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>npt.NDArray</em>) – 2-D Numpy array of image.</p></li>
<li><p><strong>thresholds</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – List of thresholds for each class.</p></li>
<li><p><strong>threshold_direction</strong> (<em>str</em>) – Direction for which the threshold is applied.</p></li>
<li><p><strong>image_name</strong> (<em>str</em>) – Name of the image being processed (used in logging).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>WxHxC Numpy array of the mask tensor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>npt.NDArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topostats.grains.Grains.remove_disconnected_grains">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">remove_disconnected_grains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">original_grain_tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predicted_grain_tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/topostats/grains.html#Grains.remove_disconnected_grains"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#topostats.grains.Grains.remove_disconnected_grains" title="Link to this definition">#</a></dt>
<dd><p>Remove grains that are not connected to the original grains.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>original_grain_tensor</strong> (<em>npt.NDArray</em>) – 3-D Numpy array of the original grain tensor.</p></li>
<li><p><strong>predicted_grain_tensor</strong> (<em>npt.NDArray</em>) – 3-D Numpy array of the predicted grain tensor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>3-D Numpy array of the predicted grain tensor with grains not connected to the original grains removed.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>npt.NDArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topostats.grains.Grains.remove_objects_too_small_to_process">
<span class="sig-name descname"><span class="pre">remove_objects_too_small_to_process</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minimum_size_px</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minimum_bbox_size_px</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/topostats/grains.html#Grains.remove_objects_too_small_to_process"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#topostats.grains.Grains.remove_objects_too_small_to_process" title="Link to this definition">#</a></dt>
<dd><p>Remove objects whose dimensions in pixels are too small to process.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>npt.NDArray</em>) – 2-D Numpy array of image.</p></li>
<li><p><strong>minimum_size_px</strong> (<em>int</em>) – Minimum number of pixels for an object.</p></li>
<li><p><strong>minimum_bbox_size_px</strong> (<em>int</em>) – Limit for the minimum dimension of an object in pixels. Eg: 5 means the object’s bounding box must be at
least 5x5.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>2-D Numpy array of image with objects removed that are too small to process.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>npt.NDArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topostats.grains.Grains.tidy_border_tensor">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tidy_border_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grain_mask_tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/topostats/grains.html#Grains.tidy_border_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#topostats.grains.Grains.tidy_border_tensor" title="Link to this definition">#</a></dt>
<dd><p>Remove whole grains touching the border.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>grain_mask_tensor</strong> (<em>npt.NDArray</em>) – 3-D Numpy array of the grain mask tensor.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>3-D Numpy array of the grain mask tensor with grains touching the border removed.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>npt.NDArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topostats.grains.Grains.update_background_class">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">update_background_class</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grain_mask_tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/topostats/grains.html#Grains.update_background_class"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#topostats.grains.Grains.update_background_class" title="Link to this definition">#</a></dt>
<dd><p>Update the background class to reflect the other classes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>grain_mask_tensor</strong> (<em>npt.NDArray</em>) – 3-D Numpy array of the grain mask tensor.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>3-D Numpy array of image tensor with updated background class.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>npt.NDArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topostats.grains.Grains.vet_class_connection_points">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">vet_class_connection_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grain_mask_tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_connection_point_thresholds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/topostats/grains.html#Grains.vet_class_connection_points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#topostats.grains.Grains.vet_class_connection_points" title="Link to this definition">#</a></dt>
<dd><p>Vet the number of connection points between regions in specific classes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grain_mask_tensor</strong> (<em>npt.NDArray</em>) – 3-D Numpy array of the grain mask tensor.</p></li>
<li><p><strong>class_connection_point_thresholds</strong> (<em>list</em><em>[</em><em>tuple</em><em>[</em><em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>, </em><em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em><em>] </em><em>| </em><em>None</em>) – List of tuples of classes and connection point thresholds. Structure is [(class_pair, (lower, upper))].</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if the grain passes the vetting, False if it fails.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topostats.grains.Grains.vet_class_sizes_single_grain">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">vet_class_sizes_single_grain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">single_grain_mask_tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_to_nm_scaling</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_size_thresholds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/topostats/grains.html#Grains.vet_class_sizes_single_grain"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#topostats.grains.Grains.vet_class_sizes_single_grain" title="Link to this definition">#</a></dt>
<dd><p>Remove regions of particular classes based on size thresholds.</p>
<p>Regions of classes that are too large or small may need to be removed for many reasons (eg removing noise
erroneously detected by the model or larger-than-expected molecules that are obviously erroneous), this method
allows for the removal of these regions based on size thresholds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>single_grain_mask_tensor</strong> (<em>npt.NDArray</em>) – 3-D Numpy array of the mask tensor.</p></li>
<li><p><strong>pixel_to_nm_scaling</strong> (<em>float</em>) – Scaling of pixels to nanometres.</p></li>
<li><p><strong>class_size_thresholds</strong> (<em>list</em><em>[</em><em>list</em><em>[</em><em>int</em><em>, </em><em>int</em><em>, </em><em>int</em><em>]</em><em>] </em><em>| </em><em>None</em>) – List of class size thresholds. Structure is [(class_index, lower, upper)].</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>npt.NDArray</em> – 3-D Numpy array of the mask tensor with grains removed based on size thresholds.</p></li>
<li><p><em>bool</em> – True if the grain passes the vetting, False if it fails.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topostats.grains.Grains.vet_grains">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">vet_grains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graincrops</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#topostats.grains.GrainCrop" title="topostats.grains.GrainCrop"><span class="pre">GrainCrop</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">whole_grain_size_thresholds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_conversion_size_thresholds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_size_thresholds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_region_number_thresholds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nearby_conversion_classes_to_convert</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_touching_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_largest_labelled_regions_classes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_connection_point_thresholds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#topostats.grains.GrainCrop" title="topostats.grains.GrainCrop"><span class="pre">GrainCrop</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/topostats/grains.html#Grains.vet_grains"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#topostats.grains.Grains.vet_grains" title="Link to this definition">#</a></dt>
<dd><p>Vet grains in a grain mask tensor based on a variety of criteria.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>graincrops</strong> (<em>dict</em><em>[</em><em>int</em><em>, </em><a class="reference internal" href="#topostats.grains.GrainCrop" title="topostats.grains.GrainCrop"><em>GrainCrop</em></a><em>]</em>) – Dictionary of grain crops.</p></li>
<li><p><strong>whole_grain_size_thresholds</strong> (<em>tuple</em>) – Tuple of whole grain size thresholds. Structure is (lower, upper).</p></li>
<li><p><strong>class_conversion_size_thresholds</strong> (<em>list</em>) – List of class conversion size thresholds. Structure is [(class_index, class_to_convert_to_if_too_small,
class_to_convert_to_if_too_big), (lower_threshold, upper_threshold)].</p></li>
<li><p><strong>class_size_thresholds</strong> (<em>list</em>) – List of class size thresholds. Structure is [(class_index, lower, upper)].</p></li>
<li><p><strong>class_region_number_thresholds</strong> (<em>list</em>) – List of class region number thresholds. Structure is [(class_index, lower, upper)].</p></li>
<li><p><strong>nearby_conversion_classes_to_convert</strong> (<em>list</em>) – List of tuples of classes to convert. Structure is [(class_a, class_b)].</p></li>
<li><p><strong>class_touching_threshold</strong> (<em>int</em>) – Number of dilation passes to do to determine class A connectivity with class B.</p></li>
<li><p><strong>keep_largest_labelled_regions_classes</strong> (<em>list</em>) – List of classes to keep only the largest region.</p></li>
<li><p><strong>class_connection_point_thresholds</strong> (<em>list</em>) – List of tuples of classes and connection point thresholds. Structure is [(class_pair, (lower, upper))].</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary of grain crops that passed the vetting.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict[int, <a class="reference internal" href="#topostats.grains.GrainCrop" title="topostats.grains.GrainCrop">GrainCrop</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topostats.grains.Grains.vet_numbers_of_regions_single_grain">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">vet_numbers_of_regions_single_grain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grain_mask_tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_region_number_thresholds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/topostats/grains.html#Grains.vet_numbers_of_regions_single_grain"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#topostats.grains.Grains.vet_numbers_of_regions_single_grain" title="Link to this definition">#</a></dt>
<dd><p>Check if the number of regions of different classes for a single grain is within thresholds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grain_mask_tensor</strong> (<em>npt.NDArray</em>) – 3-D Numpy array of the grain mask tensor, should be of only one grain.</p></li>
<li><p><strong>class_region_number_thresholds</strong> (<em>list</em><em>[</em><em>list</em><em>[</em><em>int</em><em>, </em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em>) – List of class region number thresholds. Structure is [(class_index, lower, upper)].</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>npt.NDArray</em> – 3-D Numpy array of the grain mask tensor with grains removed based on region number thresholds.</p></li>
<li><p><em>bool</em> – True if the grain passes the vetting, False if it fails.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topostats.grains.Grains.vet_whole_grain_size">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">vet_whole_grain_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grain_mask_tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_to_nm_scaling</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">whole_grain_size_thresholds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/topostats/grains.html#Grains.vet_whole_grain_size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#topostats.grains.Grains.vet_whole_grain_size" title="Link to this definition">#</a></dt>
<dd><p>Vet the size of the whole grain based on size thresholds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grain_mask_tensor</strong> (<em>npt.NDArray</em>) – 3-D Numpy array of the grain mask tensor.</p></li>
<li><p><strong>pixel_to_nm_scaling</strong> (<em>float</em>) – Scaling of pixels to nanometres.</p></li>
<li><p><strong>whole_grain_size_thresholds</strong> (<em>tuple</em>) – Tuple of whole grain size thresholds. Structure is (lower, upper).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if the grain size is within the area thresholds, False if it fails.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="topostats.grains.ImageGrainCrops">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">topostats.grains.</span></span><span class="sig-name descname"><span class="pre">ImageGrainCrops</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">above</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#topostats.grains.GrainCropsDirection" title="topostats.grains.GrainCropsDirection"><span class="pre">GrainCropsDirection</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">below</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#topostats.grains.GrainCropsDirection" title="topostats.grains.GrainCropsDirection"><span class="pre">GrainCropsDirection</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/topostats/grains.html#ImageGrainCrops"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#topostats.grains.ImageGrainCrops" title="Link to this definition">#</a></dt>
<dd><p>Dataclass for storing the crops of grains in an image.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="topostats.grains.ImageGrainCrops.above">
<span class="sig-name descname"><span class="pre">above</span></span><a class="headerlink" href="#topostats.grains.ImageGrainCrops.above" title="Link to this definition">#</a></dt>
<dd><p>Grains in the above direction.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>GrainCropDirection | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="topostats.grains.ImageGrainCrops.below">
<span class="sig-name descname"><span class="pre">below</span></span><a class="headerlink" href="#topostats.grains.ImageGrainCrops.below" title="Link to this definition">#</a></dt>
<dd><p>Grains in the below direction.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>GrainCropDirection | None</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#topostats.grains.ImageGrainCrops.debug_locate_difference" title="topostats.grains.ImageGrainCrops.debug_locate_difference"><code class="xref py py-obj docutils literal notranslate"><span class="pre">debug_locate_difference</span></code></a>(other)</p></td>
<td><p>Debug function to find the culprit when two ImageGrainCrops objects are not equal.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#topostats.grains.ImageGrainCrops.image_grain_crops_to_dict" title="topostats.grains.ImageGrainCrops.image_grain_crops_to_dict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">image_grain_crops_to_dict</span></code></a>()</p></td>
<td><p>Convert ImageGrainCrops to dictionary indexed by attributes.</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="topostats.grains.ImageGrainCrops.debug_locate_difference">
<span class="sig-name descname"><span class="pre">debug_locate_difference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">object</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/topostats/grains.html#ImageGrainCrops.debug_locate_difference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#topostats.grains.ImageGrainCrops.debug_locate_difference" title="Link to this definition">#</a></dt>
<dd><p>Debug function to find the culprit when two ImageGrainCrops objects are not equal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>other</strong> (<em>object</em>) – Object to compare to.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the objects are not equal.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topostats.grains.ImageGrainCrops.image_grain_crops_to_dict">
<span class="sig-name descname"><span class="pre">image_grain_crops_to_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict[str,</span> <span class="pre">~numpy.ndarray[~typing.Any,</span> <span class="pre">~numpy.dtype[~numpy.bool]]</span> <span class="pre">|</span> <span class="pre">dict[slice(&lt;class</span> <span class="pre">'str'&gt;,</span> <span class="pre">typing.Any,</span> <span class="pre">None)]]</span></span></span><a class="reference internal" href="_modules/topostats/grains.html#ImageGrainCrops.image_grain_crops_to_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#topostats.grains.ImageGrainCrops.image_grain_crops_to_dict" title="Link to this definition">#</a></dt>
<dd><p>Convert ImageGrainCrops to dictionary indexed by attributes.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary indexed by attribute of the grain attributes.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict[str, Any]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="topostats.grains.validate_full_mask_tensor_shape">
<span class="sig-prename descclassname"><span class="pre">topostats.grains.</span></span><span class="sig-name descname"><span class="pre">validate_full_mask_tensor_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/topostats/grains.html#validate_full_mask_tensor_shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#topostats.grains.validate_full_mask_tensor_shape" title="Link to this definition">#</a></dt>
<dd><p>Validate the shape of the full mask tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>array</strong> (<em>npt.NDArray</em>) – Numpy array to validate.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Numpy array if valid.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>npt.NDArray</p>
</dd>
</dl>
</dd></dl>

</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="topostats.filters.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">filters</p>
      </div>
    </a>
    <a class="right-next"
       href="topostats.grainstats.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">grainstats</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.GrainCrop"><code class="docutils literal notranslate"><span class="pre">GrainCrop</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.GrainCrop.bbox"><code class="docutils literal notranslate"><span class="pre">GrainCrop.bbox</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.GrainCrop.debug_locate_difference"><code class="docutils literal notranslate"><span class="pre">GrainCrop.debug_locate_difference()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.GrainCrop.filename"><code class="docutils literal notranslate"><span class="pre">GrainCrop.filename</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.GrainCrop.grain_crop_to_dict"><code class="docutils literal notranslate"><span class="pre">GrainCrop.grain_crop_to_dict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.GrainCrop.height_profiles"><code class="docutils literal notranslate"><span class="pre">GrainCrop.height_profiles</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.GrainCrop.image"><code class="docutils literal notranslate"><span class="pre">GrainCrop.image</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.GrainCrop.mask"><code class="docutils literal notranslate"><span class="pre">GrainCrop.mask</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.GrainCrop.padding"><code class="docutils literal notranslate"><span class="pre">GrainCrop.padding</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.GrainCrop.pixel_to_nm_scaling"><code class="docutils literal notranslate"><span class="pre">GrainCrop.pixel_to_nm_scaling</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.GrainCrop.stats"><code class="docutils literal notranslate"><span class="pre">GrainCrop.stats</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.GrainCropsDirection"><code class="docutils literal notranslate"><span class="pre">GrainCropsDirection</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.GrainCropsDirection.full_mask_tensor"><code class="docutils literal notranslate"><span class="pre">GrainCropsDirection.full_mask_tensor</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.GrainCropsDirection.crops"><code class="docutils literal notranslate"><span class="pre">GrainCropsDirection.crops</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.GrainCropsDirection.debug_locate_difference"><code class="docutils literal notranslate"><span class="pre">GrainCropsDirection.debug_locate_difference()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id0"><code class="docutils literal notranslate"><span class="pre">GrainCropsDirection.full_mask_tensor</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.GrainCropsDirection.grain_crops_direction_to_dict"><code class="docutils literal notranslate"><span class="pre">GrainCropsDirection.grain_crops_direction_to_dict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.GrainCropsDirection.update_full_mask_tensor"><code class="docutils literal notranslate"><span class="pre">GrainCropsDirection.update_full_mask_tensor()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.Grains"><code class="docutils literal notranslate"><span class="pre">Grains</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.Grains.area_thresholding_tensor"><code class="docutils literal notranslate"><span class="pre">Grains.area_thresholding_tensor()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.Grains.assemble_grain_mask_tensor_from_crops"><code class="docutils literal notranslate"><span class="pre">Grains.assemble_grain_mask_tensor_from_crops()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.Grains.bbox_size_thresholding_tensor"><code class="docutils literal notranslate"><span class="pre">Grains.bbox_size_thresholding_tensor()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.Grains.calculate_region_connection_regions"><code class="docutils literal notranslate"><span class="pre">Grains.calculate_region_connection_regions()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.Grains.construct_full_mask_from_graincrops"><code class="docutils literal notranslate"><span class="pre">Grains.construct_full_mask_from_graincrops()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.Grains.convert_classes_to_nearby_classes"><code class="docutils literal notranslate"><span class="pre">Grains.convert_classes_to_nearby_classes()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.Grains.convert_classes_when_too_big_or_small"><code class="docutils literal notranslate"><span class="pre">Grains.convert_classes_when_too_big_or_small()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.Grains.extract_grains_from_full_image_tensor"><code class="docutils literal notranslate"><span class="pre">Grains.extract_grains_from_full_image_tensor()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.Grains.find_grains"><code class="docutils literal notranslate"><span class="pre">Grains.find_grains()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.Grains.flatten_multi_class_tensor"><code class="docutils literal notranslate"><span class="pre">Grains.flatten_multi_class_tensor()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.Grains.get_individual_grain_crops"><code class="docutils literal notranslate"><span class="pre">Grains.get_individual_grain_crops()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.Grains.get_multi_class_grain_bounding_boxes"><code class="docutils literal notranslate"><span class="pre">Grains.get_multi_class_grain_bounding_boxes()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.Grains.get_region_properties"><code class="docutils literal notranslate"><span class="pre">Grains.get_region_properties()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.Grains.graincrops_merge_classes"><code class="docutils literal notranslate"><span class="pre">Grains.graincrops_merge_classes()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.Grains.graincrops_remove_objects_too_small_to_process"><code class="docutils literal notranslate"><span class="pre">Grains.graincrops_remove_objects_too_small_to_process()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.Grains.graincrops_update_background_class"><code class="docutils literal notranslate"><span class="pre">Grains.graincrops_update_background_class()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.Grains.improve_grain_segmentation_unet"><code class="docutils literal notranslate"><span class="pre">Grains.improve_grain_segmentation_unet()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.Grains.keep_largest_labelled_region"><code class="docutils literal notranslate"><span class="pre">Grains.keep_largest_labelled_region()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.Grains.keep_largest_labelled_region_classes"><code class="docutils literal notranslate"><span class="pre">Grains.keep_largest_labelled_region_classes()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.Grains.label_regions"><code class="docutils literal notranslate"><span class="pre">Grains.label_regions()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.Grains.merge_classes"><code class="docutils literal notranslate"><span class="pre">Grains.merge_classes()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.Grains.multi_class_thresholding"><code class="docutils literal notranslate"><span class="pre">Grains.multi_class_thresholding()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.Grains.remove_disconnected_grains"><code class="docutils literal notranslate"><span class="pre">Grains.remove_disconnected_grains()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.Grains.remove_objects_too_small_to_process"><code class="docutils literal notranslate"><span class="pre">Grains.remove_objects_too_small_to_process()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.Grains.tidy_border_tensor"><code class="docutils literal notranslate"><span class="pre">Grains.tidy_border_tensor()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.Grains.update_background_class"><code class="docutils literal notranslate"><span class="pre">Grains.update_background_class()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.Grains.vet_class_connection_points"><code class="docutils literal notranslate"><span class="pre">Grains.vet_class_connection_points()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.Grains.vet_class_sizes_single_grain"><code class="docutils literal notranslate"><span class="pre">Grains.vet_class_sizes_single_grain()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.Grains.vet_grains"><code class="docutils literal notranslate"><span class="pre">Grains.vet_grains()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.Grains.vet_numbers_of_regions_single_grain"><code class="docutils literal notranslate"><span class="pre">Grains.vet_numbers_of_regions_single_grain()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.Grains.vet_whole_grain_size"><code class="docutils literal notranslate"><span class="pre">Grains.vet_whole_grain_size()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.ImageGrainCrops"><code class="docutils literal notranslate"><span class="pre">ImageGrainCrops</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.ImageGrainCrops.above"><code class="docutils literal notranslate"><span class="pre">ImageGrainCrops.above</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.ImageGrainCrops.below"><code class="docutils literal notranslate"><span class="pre">ImageGrainCrops.below</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.ImageGrainCrops.debug_locate_difference"><code class="docutils literal notranslate"><span class="pre">ImageGrainCrops.debug_locate_difference()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.ImageGrainCrops.image_grain_crops_to_dict"><code class="docutils literal notranslate"><span class="pre">ImageGrainCrops.image_grain_crops_to_dict()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#topostats.grains.validate_full_mask_tensor_shape"><code class="docutils literal notranslate"><span class="pre">validate_full_mask_tensor_shape()</span></code></a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/topostats.grains.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2023, TopoStats authors.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>