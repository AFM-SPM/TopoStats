
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Disordered Tracing &#8212; TopoStats 2.3.3.dev27+g279473507 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=2b4ec01c" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../_static/documentation_options.js?v=766c09a3"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'advanced/disordered_tracing';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="2.3" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">TopoStats 2.3.3.dev27+g279473507 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../introduction.html">
    Introduction
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../installation.html">
    Installation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../usage.html">
    Usage
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../configuration.html">
    Configuration
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../contributing.html">
    Contributing
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button"
                data-bs-toggle="dropdown" aria-expanded="false"
                aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../notebooks.html">
    Notebooks
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../advanced.html">
    Advanced Documentation
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../workflow.html">
    Workflow
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../data_dictionary.html">
    Data Dictionary
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../related_software.html">
    Related Software
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../glossary.html">
    Glossary
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../faq.html">
    Frequently Asked Questions
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../autoapi/index.html">
    API Reference
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../introduction.html">
    Introduction
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../installation.html">
    Installation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../usage.html">
    Usage
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../configuration.html">
    Configuration
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../contributing.html">
    Contributing
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../notebooks.html">
    Notebooks
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../advanced.html">
    Advanced Documentation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../workflow.html">
    Workflow
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../data_dictionary.html">
    Data Dictionary
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../related_software.html">
    Related Software
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../glossary.html">
    Glossary
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../faq.html">
    Frequently Asked Questions
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../autoapi/index.html">
    API Reference
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<h3>Versions</h3>
<ul>
  <li><a href="../../v2.0.0/index.html">v2.0.0</a></li>
  <li><a href="../../v2.1.0/index.html">v2.1.0</a></li>
  <li><a href="../../v2.1.1/index.html">v2.1.1</a></li>
  <li><a href="../../v2.1.2/index.html">v2.1.2</a></li>
  <li><a href="../../v2.2.0/index.html">v2.2.0</a></li>
  <li><a href="../../v2.2.1/index.html">v2.2.1</a></li>
  <li><a href="../../v2.2.post0/index.html">v2.2.post0</a></li>
  <li><a href="../../v2.3.0/advanced/disordered_tracing.html">v2.3.0</a></li>
  <li><a href="../../v2.3.1/advanced/disordered_tracing.html">v2.3.1</a></li>
  <li><a href="../../v2.3.2/advanced/disordered_tracing.html">v2.3.2</a></li>
  <li><a href="../../v2.3.2rc1/advanced/disordered_tracing.html">v2.3.2rc1</a></li>
  <li><a href="disordered_tracing.html">v2.3.2rc2</a></li>
  <li><a href="../../main/advanced/disordered_tracing.html">main</a></li>
</ul>
</div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Disordered Tracing</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="disordered-tracing">
<h1>Disordered Tracing<a class="headerlink" href="#disordered-tracing" title="Link to this heading">#</a></h1>
<p>This section gives an in-depth overview of the steps taken in the disordered tracing module.</p>
<section id="at-a-glance-simple-representations">
<h2>At a Glance : Simple Representations<a class="headerlink" href="#at-a-glance-simple-representations" title="Link to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">disordered_tracing.py</span></code> module handles all the functions associated with obtaining single-pixel wide, line
representations of masked objects.</p>
<p>The quality and likeness of the resultant pruned skeleton thus depends on the quality of the mask, the effectiveness of
smoothing parameters, the method of skeletonisation, and the quality of automating the pruning of incorrect skeletal
branches.</p>
<p><img alt="object mask to pruned skeleton" src="../_images/overview.png" /></p>
<p>This module measures the number of junctions and endpoints for each pruned skeleton object and appends these columns to
the <code class="docutils literal notranslate"><span class="pre">grain_statistics.csv</span></code>. In addition, the <code class="docutils literal notranslate"><span class="pre">branch_statistics.csv</span></code> file is produced which measures the
length, type, connections, and pixel value (typically height); minimum, middle, median, mean and standard deviation for
each skeleton segment between junctions using <a class="reference external" href="https://skeleton-analysis.org/stable/index.html">Skan</a>. The branch types
are given by:</p>
<ul class="simple">
<li><p>0: Endpoint-to-endpoint</p></li>
<li><p>1: Endpoint-to-junction</p></li>
<li><p>2: Junction-to-junction</p></li>
<li><p>3: Isolated cycle</p></li>
</ul>
<p>Some useful points to bear in mind:</p>
<ul class="simple">
<li><p><strong>Bad mask, bad skeleton</strong> - If the mask closes holes seen in the image, all skeletonisation methods will produce a
single line for this region.</p></li>
<li><p><strong>No skeletons in image</strong> - The disordered trace <code class="docutils literal notranslate"><span class="pre">core</span></code> image may not show the resultant skeletons if the plotting
<code class="docutils literal notranslate"><span class="pre">dpi</span></code> value is too low (varies based on image size).</p></li>
<li><p><strong>Hard to remove branches</strong> - If there are still spurious branches to prune after modifying the
<code class="docutils literal notranslate"><span class="pre">mask_smoothing_params</span></code> and <code class="docutils literal notranslate"><span class="pre">pruning_params</span></code>, try increasing the <code class="docutils literal notranslate"><span class="pre">filters.gaussian_size</span></code> value to smooth the image the
mask is created from.</p></li>
<li><p><strong>Masked colours are relative</strong> - Any mask colours that may be produced by plots are relative to the mask values in
that image as they will always span the masked colourmap, and will not compare well across images if the range of mask
values differ.</p></li>
</ul>
</section>
<section id="processing-steps">
<h2>Processing Steps<a class="headerlink" href="#processing-steps" title="Link to this heading">#</a></h2>
<section id="smoothing-the-mask">
<h3>1. Smoothing the Mask<a class="headerlink" href="#smoothing-the-mask" title="Link to this heading">#</a></h3>
<p>Generated masks can be quite jagged which causes a large increase in spurious skeletal branches which do not best
represent the image. This can be resolved by first smoothing the incoming mask.</p>
<p><img alt="Image of smoothed vs un-smoothed skeletonisation result" src="../_images/smoothing.png" /></p>
<p>Smoothing uses either binary dilation (expanding the borders of the mask <code class="docutils literal notranslate"><span class="pre">dilation_iterations</span></code> times) or an otsu
threshold applied to a gaussian filtered mask (with a smoothing factor of <code class="docutils literal notranslate"><span class="pre">gaussian_sigma</span></code>). If both values are provided
an input in the configuration file, they will compete, and the winning result is the one with the smallest number of
added pixels.</p>
<p>The reason for the competition is an attempt to conserve mask topology i.e. any small holes it has which may become
closed upon dilation / gaussian blurring. The dilation method seems to work best for larger masks where there are more
mask pixels, and the gaussian smoothing better when there are small holes.</p>
<p>In addition, this smoothing step also tries to preserve mask topology by re-adding any holes back into the mask that lie
within the <code class="docutils literal notranslate"><span class="pre">holearea_min_max</span></code> threshold. This has the resulting effect of only smoothing the outer edge of the mask.</p>
<p>If required, the function can also take <code class="docutils literal notranslate"><span class="pre">null</span></code> values for both <code class="docutils literal notranslate"><span class="pre">dilation_iteration</span></code> and <code class="docutils literal notranslate"><span class="pre">gaussian_sigma</span></code> values to
return the original grain. This is useful for retaining the sample topology when the masking / segmentation is good
enough, for example when you use finely-trained deep learning models.</p>
</section>
<section id="skeletonisation">
<h3>2. Skeletonisation<a class="headerlink" href="#skeletonisation" title="Link to this heading">#</a></h3>
<p>Skeletonisation is the process of reducing a binary image to a single-pixel wide representation. This can be done using
the algorithms provided by <a class="reference external" href="https://scikit-image.org/docs/stable/auto_examples/edges/plot_skeleton.html">scikit-image</a>
such as <code class="docutils literal notranslate"><span class="pre">zhang</span></code> (rule based + erosion), <code class="docutils literal notranslate"><span class="pre">lee</span></code> (connectivity preserving), <code class="docutils literal notranslate"><span class="pre">medial_axis</span></code> (pixels with &gt;1 closest boundary
pixels), or <code class="docutils literal notranslate"><span class="pre">topostats</span></code> - a modification of Zhang’s algorithm which uses the underlying height information to order and
then remove only a percentage of the pixels marked for removal on each skeletonisation iteration. The skeletonisation
methods are handled by the <code class="docutils literal notranslate"><span class="pre">tracing/skeletonize.py</span></code> module.</p>
<p><img alt="Comparison between skeletonisation algorithms" src="../_images/skeletons.png" /></p>
<p>We have found that by including the height information into the skeletonisation process and removing the lowest
<code class="docutils literal notranslate"><span class="pre">height_bias</span></code> percent, we can bias the skeleton to lie on the DNA backbone and generate a better representation of the
molecule, especially at crossing points and regions where the mask is less accurate.</p>
<p><img alt="Different skeletonisation height bias examples" src="../_images/height_bias.png" /></p>
</section>
<section id="pruning">
<h3>3. Pruning<a class="headerlink" href="#pruning" title="Link to this heading">#</a></h3>
<p>Pruning is the act of removing spurious branches from a skeleton which does not follow the underlying masks’ shape. To
this end, TopoStats provides a variety of methods and parameters to help clean up the skeletons.</p>
<p><img alt="Pre and post pruning of skeletons" src="../_images/pruning.png" /></p>
<p>Pruning can be done by branch length (using the <code class="docutils literal notranslate"><span class="pre">max_length</span></code> configuration parameter) and / or the branch height (using
the <code class="docutils literal notranslate"><span class="pre">height_threshold</span></code>, <code class="docutils literal notranslate"><span class="pre">method_values</span></code> and <code class="docutils literal notranslate"><span class="pre">method_outliers</span></code> configuration parameters).</p>
<p>Length pruning is the simplest, iteratively comparing the length (in nm) of each branch containing an endpoint with the
<code class="docutils literal notranslate"><span class="pre">max_length</span></code> parameter. If it’s length is below this value, it is deemed as a spurious branch and removed, along with
any junction pixels until a single-pixel skeleton remains.</p>
<p>Height pruning also iteratively compares the branches pixel values (height) to a <code class="docutils literal notranslate"><span class="pre">height_threshold</span></code> parameter, again,
any branch heights which are below this value are pruned. However, as there are multiple pixels in a branch, we provide
different methods to obtain a single branch height value for comparison i.e. <code class="docutils literal notranslate"><span class="pre">method_values</span></code>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">min</span></code> - the minimum value of all the branch pixel values.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">median</span></code>- the median value of all the branch pixel values.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mid</span></code> - the middle value (averaged if two) of the ordered branch pixels. This is particularly useful for pruning false
bridges where the height dips in the middle of the branch.</p></li>
</ul>
<p>Additionally, how these branch height values compare to the <code class="docutils literal notranslate"><span class="pre">height_threshold</span></code> is also considered i.e <code class="docutils literal notranslate"><span class="pre">method_outliers</span></code>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">abs</span></code> - prunes branch values below the absolute value of the <code class="docutils literal notranslate"><span class="pre">height_threshold</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mean_abs</span></code> - prunes branch values below the whole skeleton mean pixel value - absolute threshold. This is useful for
non-surface samples or periodic structures e.g. in DNA we expect the mean height to be around 2nm, but high resolution
imaging may cause this to dip to 0.8nm (the depth of a major groove), so we’d want to prune branch heights below this.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">iqr</span></code> - prunes branch values below 1.5x inter-quartile range (IQR) of all the branches. Height pruning cannot produce
more than one skeleton and so avoids breaking up the skeleton into multiple parts.</p></li>
</ul>
</section>
</section>
<section id="outputs">
<h2>Outputs<a class="headerlink" href="#outputs" title="Link to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">&lt;image&gt;_&lt;threshold&gt;_disordered_trace</span></code> image shows the pruned skeletons that are used to obtain the below metrics
and passed onto future processing stages.</p>
<p>For each grain, the following new columns are added to the <code class="docutils literal notranslate"><span class="pre">grainstats.csv</span></code> file:</p>
<table border="1" class="docutils">
<thead>
<tr>
<th>Column Name</th>
<th>Description</th>
<th>Data Type</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>grain_endpoints</code></td>
<td>The number of pixels designated as endpoints (only 1 neighbour) in the pruned skeleton.</td>
<td><code>integer</code></td>
</tr>
<tr>
<td><code>grain_junctions</code></td>
<td>The number of pixels designated as junctions (&gt;2 neighbours) in the pruned skeleton.</td>
<td><code>integer</code></td>
</tr>
<tr>
<td><code>total_branch_length</code></td>
<td>The sum of all branch lengths in the pruned skeleton.</td>
<td><code>float</code></td>
</tr>
</tbody>
</table>
<p> </p>
<p><img alt="Disordered tracing grain metrics visualisation" src="../_images/ts2_dis_metrics.png" /></p>
<section id="disordered-segment-statistics">
<h3>Disordered Segment Statistics<a class="headerlink" href="#disordered-segment-statistics" title="Link to this heading">#</a></h3>
<p>A <code class="docutils literal notranslate"><span class="pre">branch_statistics.csv</span></code> file is produced for each image which measures the following metrics from
each segment in each pruned skeleton:</p>
<table border="1" class="docutils">
<thead>
<tr>
<th>Column Name</th>
<th>Description</th>
<th>Data Type</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>image</code></td>
<td>The image name being processed.</td>
<td><code>string</code></td>
</tr>
<tr>
<td><code>threshold</code></td>
<td>The direction of the grain threshold being applied.</td>
<td><code>string</code></td>
</tr>
<tr>
<td><code>grain_number</code></td>
<td>The number of the grain being processed in the image.</td>
<td><code>integer</code></td>
</tr>
<tr>
<td><code>index</code></td>
<td>The branch index.</td>
<td><code>integer</code></td>
</tr>
<tr>
<td><code>branch-distance</code></td>
<td>The distance (in nm) of the branch.</td>
<td><code>float</code></td>
</tr>
<tr>
<td><code>branch-type</code></td>
<td>Branch classification of endpoint-to-endpoint (0), endpoint-to-junction (1), junction-to-junction (2), isolated cycle (3).</td>
<td><code>integer</code></td>
</tr>
<tr>
<td><code>connected_segments</code></td>
<td>The index of the branch segments that this current branch is connected to via a junction point.</td>
<td><code>list</code></td>
</tr>
<tr>
<td><code>mean-pixel-value</code></td>
<td>The mean of the branch pixel values (height), in nm.</td>
<td><code>float</code></td>
</tr>
<tr>
<td><code>stdev-pixel-value</code></td>
<td>The standard deviation of the branch pixel values (height), in nm.</td>
<td><code>float</code></td>
</tr>
<tr>
<td><code>min-value</code></td>
<td>The minimum value of the branch pixel values (height), in nm.</td>
<td><code>float</code></td>
</tr>
<tr>
<td><code>median-value</code></td>
<td>The median value of the branch pixel values (height), in nm.</td>
<td><code>float</code></td>
</tr>
<tr>
<td><code>mid-value</code></td>
<td>The value of a pixel halfway along the ordered branch (height), in nm.</td>
<td><code>float</code></td>
</tr>
<tr>
<td><code>basename</code></td>
<td>The directory path containing the image.</td>
<td><code>string</code></td>
</tr>
</tbody>
</table>
<p> </p>
<p><img alt="Disordered tracing branch metrics visualisation" src="../_images/ts2_metrics-branch.png" /></p>
</section>
</section>
<section id="diagnostic-images">
<h2>Diagnostic Images<a class="headerlink" href="#diagnostic-images" title="Link to this heading">#</a></h2>
<p>Images produced by the <code class="docutils literal notranslate"><span class="pre">plotting.image_set:</span> <span class="pre">all</span></code> for this module are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">21-smoothed_grains</span></code> - The smoothed mask, used to check that the image topology is retained (holes) before
skeletonisation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">22-original_skeletons</span></code> - Skeletonised mask, used to ensure the skeletons follow the underlying structures. Used to
check if the skeletonisation parameters are suitable.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">23-branch_indexes</span></code> - An integer mask of the pruned skeleton with branch pixel values matching the index value in the
data. Used to cross reference the <code class="docutils literal notranslate"><span class="pre">branch_statistics.csv</span></code> data with an image. Using the default
colourmap for this (viridris), darker (purple) colours are lower indexes, and brighter (yellow) colours are higher.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">24-branch_types</span></code> - An integer mask of the pruned skeleton with branch pixel values matching the <code class="docutils literal notranslate"><span class="pre">branch-type</span></code>
(numbers and definitions in the “At a Glance” section). This can be used to count and check if the skeletonisation
process correctly identifies the different branch types. Using the default colourmap for this (viridris), darker
(purple) colours are lower indexes, and brighter (yellow) colours are higher.</p></li>
</ul>
<p><img alt="Examples of diagnostic images" src="../_images/diagnostics.png" /></p>
</section>
<section id="possible-uses">
<h2>Possible Uses<a class="headerlink" href="#possible-uses" title="Link to this heading">#</a></h2>
<p>This module would lend itself to measuring branched structures and may aid the identification of particular regions by
filtering-out segments based on their branch type.</p>
<p>We have used this module to identify and measure the length of reverse forks in stalled DNA replication intermediates as
these structures should produce closed loops, however, the reverse forks can be identified as branches with endpoints
and their metrics identified from the data. It has also been used as part of the pipeline to obtain ordered traces along
topologically complex DNA molecules and topological classifications in our paper; <a class="reference external" href="https://www.biorxiv.org/content/10.1101/2024.06.28.601212v1">Under or Over? Tracing Complex DNA
Topologies with High Resolution Atomic Force Microscopy</a>.</p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#at-a-glance-simple-representations">At a Glance : Simple Representations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#processing-steps">Processing Steps</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#smoothing-the-mask">1. Smoothing the Mask</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#skeletonisation">2. Skeletonisation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pruning">3. Pruning</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#outputs">Outputs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#disordered-segment-statistics">Disordered Segment Statistics</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#diagnostic-images">Diagnostic Images</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#possible-uses">Possible Uses</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/advanced/disordered_tracing.md.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2023, TopoStats authors.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>